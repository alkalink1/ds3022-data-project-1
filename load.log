2025-09-22 20:45:22,858 - INFO - Connected to DuckDB instance
2025-09-22 20:45:22,859 - ERROR - An error occurred: name 'glob' is not defined
2025-09-22 20:45:52,717 - INFO - Connected to DuckDB instance
2025-09-22 20:45:52,727 - INFO - Inserting Yellow file: data/yellow_tripdata_2024-04.parquet
2025-09-22 20:45:53,768 - INFO - Inserting Yellow file: data/yellow_tripdata_2024-05.parquet
2025-09-22 20:45:54,960 - INFO - Inserting Yellow file: data/yellow_tripdata_2024-07.parquet
2025-09-22 20:45:56,040 - INFO - Inserting Yellow file: data/yellow_tripdata_2024-06.parquet
2025-09-22 20:45:57,212 - INFO - Inserting Yellow file: data/yellow_tripdata_2024-03.parquet
2025-09-22 20:45:58,349 - INFO - Inserting Yellow file: data/yellow_tripdata_2024-02.parquet
2025-09-22 20:45:59,448 - INFO - Inserting Yellow file: data/yellow_tripdata_2024-12.parquet
2025-09-22 20:46:00,760 - INFO - Inserting Yellow file: data/yellow_tripdata_2024-09.parquet
2025-09-22 20:46:02,542 - INFO - Inserting Yellow file: data/yellow_tripdata_2024-10.parquet
2025-09-22 20:46:03,944 - INFO - Inserting Yellow file: data/yellow_tripdata_2024-01.parquet
2025-09-22 20:46:05,042 - INFO - Inserting Yellow file: data/yellow_tripdata_2024-11.parquet
2025-09-22 20:46:06,252 - INFO - Inserting Yellow file: data/yellow_tripdata_2024-08.parquet
2025-09-22 20:46:07,313 - INFO - Inserting Green file: data/green_tripdata_2024-04.parquet
2025-09-22 20:46:07,354 - INFO - Inserting Green file: data/green_tripdata_2024-05.parquet
2025-09-22 20:46:07,517 - INFO - Inserting Green file: data/green_tripdata_2024-07.parquet
2025-09-22 20:46:07,567 - INFO - Inserting Green file: data/green_tripdata_2024-06.parquet
2025-09-22 20:46:07,620 - INFO - Inserting Green file: data/green_tripdata_2024-03.parquet
2025-09-22 20:46:07,789 - INFO - Inserting Green file: data/green_tripdata_2024-12.parquet
2025-09-22 20:46:07,887 - INFO - Inserting Green file: data/green_tripdata_2024-02.parquet
2025-09-22 20:46:07,950 - INFO - Inserting Green file: data/green_tripdata_2024-10.parquet
2025-09-22 20:46:08,124 - INFO - Inserting Green file: data/green_tripdata_2024-09.parquet
2025-09-22 20:46:08,177 - INFO - Inserting Green file: data/green_tripdata_2024-08.parquet
2025-09-22 20:46:08,229 - INFO - Inserting Green file: data/green_tripdata_2024-11.parquet
2025-09-22 20:46:08,391 - INFO - Inserting Green file: data/green_tripdata_2024-01.parquet
2025-09-22 20:46:08,479 - INFO - Yellow trips loaded: 41169720
2025-09-22 20:46:08,479 - INFO - Green trips loaded: 660218
2025-09-22 20:46:08,479 - INFO - Vehicle emissions loaded: 8
2025-09-25 16:09:06,505 - INFO - Connected to DuckDB instance at emissions.duckdb
2025-09-25 16:09:06,863 - INFO - Ensuring base raw tables exist
2025-09-25 16:09:06,865 - INFO - Loading vehicle_emissions from data/vehicle_emissions.csv
2025-09-25 16:09:06,873 - ERROR - Fatal error during load: Binder Error: Referenced column "taxi_type" not found in FROM clause!
Candidate bindings: "fuel_type", "vehicle_type", "mpg_city"

LINE 1: SELECT COUNT(*) AS n, LIST(DISTINCT taxi_type) AS types FROM vehicle_emissions;
                                            ^
Traceback (most recent call last):
  File "/Users/alkalink/ds3022-data-project-1/load.py", line 143, in load_parquet_files
    _load_vehicle_emissions(con, Path(EMISSIONS_CSV))
  File "/Users/alkalink/ds3022-data-project-1/load.py", line 59, in _load_vehicle_emissions
    df = con.execute("SELECT COUNT(*) AS n, LIST(DISTINCT taxi_type) AS types FROM vehicle_emissions;").fetchdf()
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
duckdb.duckdb.BinderException: Binder Error: Referenced column "taxi_type" not found in FROM clause!
Candidate bindings: "fuel_type", "vehicle_type", "mpg_city"

LINE 1: SELECT COUNT(*) AS n, LIST(DISTINCT taxi_type) AS types FROM vehicle_emissions;
                                            ^
2025-09-25 16:12:29,484 - INFO - Connected to DuckDB
2025-09-25 16:12:29,530 - INFO - httpfs extension loaded
2025-09-25 16:12:29,563 - INFO - Creating empty table yellow_trips from schema of: https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2024-01.parquet
2025-09-25 16:12:32,051 - INFO - Creating empty table green_trips from schema of: https://d37ci6vzurychx.cloudfront.net/trip-data/green_tripdata_2024-01.parquet
2025-09-25 16:12:32,188 - INFO - Inserting into yellow_trips from https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2024-01.parquet
2025-09-25 16:12:34,495 - INFO - Inserting into yellow_trips from https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2024-02.parquet
2025-09-25 16:12:37,188 - INFO - Inserting into yellow_trips from https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2024-03.parquet
2025-09-25 16:12:39,606 - INFO - Inserting into yellow_trips from https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2024-04.parquet
2025-09-25 16:12:42,569 - INFO - Inserting into yellow_trips from https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2024-05.parquet
2025-09-25 16:12:44,992 - INFO - Inserting into yellow_trips from https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2024-06.parquet
2025-09-25 16:12:49,973 - INFO - Inserting into yellow_trips from https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2024-07.parquet
2025-09-25 16:12:52,567 - INFO - Inserting into yellow_trips from https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2024-08.parquet
2025-09-25 16:12:54,621 - INFO - Inserting into yellow_trips from https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2024-09.parquet
2025-09-25 16:12:57,613 - INFO - Inserting into yellow_trips from https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2024-10.parquet
2025-09-25 16:13:00,026 - INFO - Inserting into yellow_trips from https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2024-11.parquet
2025-09-25 16:13:02,564 - INFO - Inserting into yellow_trips from https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2024-12.parquet
2025-09-25 16:13:05,802 - INFO - Inserting into green_trips from https://d37ci6vzurychx.cloudfront.net/trip-data/green_tripdata_2024-01.parquet
2025-09-25 16:13:06,196 - INFO - Inserting into green_trips from https://d37ci6vzurychx.cloudfront.net/trip-data/green_tripdata_2024-02.parquet
2025-09-25 16:13:06,703 - INFO - Inserting into green_trips from https://d37ci6vzurychx.cloudfront.net/trip-data/green_tripdata_2024-03.parquet
2025-09-25 16:13:07,300 - INFO - Inserting into green_trips from https://d37ci6vzurychx.cloudfront.net/trip-data/green_tripdata_2024-04.parquet
2025-09-25 16:13:07,713 - INFO - Inserting into green_trips from https://d37ci6vzurychx.cloudfront.net/trip-data/green_tripdata_2024-05.parquet
2025-09-25 16:13:08,283 - INFO - Inserting into green_trips from https://d37ci6vzurychx.cloudfront.net/trip-data/green_tripdata_2024-06.parquet
2025-09-25 16:13:08,754 - INFO - Inserting into green_trips from https://d37ci6vzurychx.cloudfront.net/trip-data/green_tripdata_2024-07.parquet
2025-09-25 16:13:09,188 - INFO - Inserting into green_trips from https://d37ci6vzurychx.cloudfront.net/trip-data/green_tripdata_2024-08.parquet
2025-09-25 16:13:09,793 - INFO - Inserting into green_trips from https://d37ci6vzurychx.cloudfront.net/trip-data/green_tripdata_2024-09.parquet
2025-09-25 16:13:10,281 - INFO - Inserting into green_trips from https://d37ci6vzurychx.cloudfront.net/trip-data/green_tripdata_2024-10.parquet
2025-09-25 16:13:10,753 - INFO - Inserting into green_trips from https://d37ci6vzurychx.cloudfront.net/trip-data/green_tripdata_2024-11.parquet
2025-09-25 16:13:11,277 - INFO - Inserting into green_trips from https://d37ci6vzurychx.cloudfront.net/trip-data/green_tripdata_2024-12.parquet
2025-09-25 16:13:11,624 - INFO - Loading vehicle_emissions from local file: data/vehicle_emissions.csv
2025-09-25 16:13:11,646 - INFO - Loaded rows â€” yellow: 41169720, green: 660218, emissions: 8
2025-09-25 16:30:08,577 - INFO - Connected to DuckDB instance
2025-09-25 16:30:10,448 - INFO - Loaded Yellow 2024 month 01
2025-09-25 16:30:41,681 - INFO - Loaded Yellow 2024 month 02
2025-09-25 16:31:13,825 - INFO - Loaded Yellow 2024 month 03
2025-09-25 16:31:45,479 - INFO - Loaded Yellow 2024 month 04
2025-09-25 16:32:17,072 - INFO - Loaded Yellow 2024 month 05
2025-09-25 16:32:48,525 - INFO - Loaded Yellow 2024 month 06
2025-09-25 16:33:19,953 - INFO - Loaded Yellow 2024 month 07
2025-09-25 16:33:51,218 - INFO - Loaded Yellow 2024 month 08
2025-09-25 16:34:22,879 - INFO - Loaded Yellow 2024 month 09
2025-09-25 16:34:54,662 - INFO - Loaded Yellow 2024 month 10
2025-09-25 16:35:26,168 - INFO - Loaded Yellow 2024 month 11
2025-09-25 16:35:57,915 - INFO - Loaded Yellow 2024 month 12
2025-09-25 16:36:27,920 - INFO - Loaded all Yellow 2024 files
2025-09-25 16:36:28,547 - INFO - Loaded Green 2024 month 01
2025-09-25 16:36:58,924 - INFO - Loaded Green 2024 month 02
2025-09-25 16:37:29,292 - INFO - Loaded Green 2024 month 03
2025-09-25 16:37:59,683 - INFO - Loaded Green 2024 month 04
2025-09-25 16:38:30,157 - INFO - Loaded Green 2024 month 05
2025-09-25 16:39:00,545 - INFO - Loaded Green 2024 month 06
2025-09-25 16:39:31,235 - INFO - Loaded Green 2024 month 07
2025-09-25 16:40:01,576 - INFO - Loaded Green 2024 month 08
2025-09-25 16:40:31,919 - INFO - Loaded Green 2024 month 09
2025-09-25 16:41:02,498 - INFO - Loaded Green 2024 month 10
2025-09-25 16:41:32,868 - INFO - Loaded Green 2024 month 11
2025-09-25 16:42:03,232 - INFO - Loaded Green 2024 month 12
2025-09-25 16:42:33,237 - INFO - Loaded all Green 2024 files
2025-09-25 16:42:33,260 - INFO - Loaded vehicle_emissions.csv
2025-09-25 16:42:33,307 - INFO - Yellow summary: (41169720, datetime.datetime(2002, 12, 31, 16, 46, 7), datetime.datetime(2026, 6, 26, 23, 53, 12))
2025-09-25 16:42:33,307 - INFO - Green summary: (660218, datetime.datetime(2008, 12, 31, 0, 0), datetime.datetime(2025, 1, 1, 22, 21, 15))
2025-09-25 16:42:33,307 - INFO - Emissions rows: 8
2025-09-25 16:42:33,308 - INFO - Preview of vehicle_emissions: [('yellow_taxi', 'gasoline', 25, 32, 380, 2018), ('green_taxi', 'gasoline', 28, 36, 350, 2019), ('uber_x', 'gasoline', 30, 38, 320, 2020), ('uber_xl', 'gasoline', 22, 28, 450, 2019), ('lyft', 'gasoline', 29, 37, 330, 2020)]
